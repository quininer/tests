<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=utf-8">
        <meta name='referrer' content='never'>
        <title>innerHTML TestTool</title>
        <script>if(document.location.protocol == 'http:')document.location.protocol = 'https';</script>
        <style>
            #canvas, #text {
                width:100%;
                height:20em;
                overflow-y:scroll
            }
        </style>
        <script src='./static/tabIndent.js'></script>
    </head>
    <body>
        <textarea id="text"></textarea><hr>
        <iframe id="canvas" sandbox="allow-scripts allow-forms allow-popups allow-pointer-lock"></iframe><hr>
        <button id="button">Open to Tab</button>
        <script>
            var text = document.getElementById('text'),
                canvas = document.getElementById('canvas'),
                button = document.getElementById('button');
            if(document.location.hash.length>1){
                text.value = atob(document.location.hash.slice(1))
            };
            document.location.hash = '';

            window.onload = text.onkeyup = function(e){
                if(e && e.keyCode && !((e.keyCode == 10 || e.keyCode == 13) && e.ctrlKey)){
                    return false;
                };
                canvas.src = URL.createObjectURL(new Blob([text.value,], {type:"text/html"}));
                location.hash = btoa(text.value); // a little document.write() backup
            };

            button.onclick = function(){
                window.open(canvas.src);
            };
        </script>
        <script>
            tabIndent.config.tab = '    ';
            tabIndent.render(document.getElementById('text'));
        </script>
    </body>
</html>
