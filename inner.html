<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=utf-8">
        <meta name='referrer' content='never'>
        <title>innerHTML TestTool</title>
        <style>
            #canvas, #html {
                width:100%;
                height:17em;
                overflow-y:scroll
            }
        </style>
    </head>
    <body>
        <textarea id="html"></textarea><hr>
        <iframe id="canvas"></iframe><hr>
        <button id="button">Open to Tab</button>
        <script>
            var html = document.getElementById('html'),
                canvas = document.getElementById('canvas'),
                button = document.getElementById('button');

            document.location.hash.length > 1 ? html.value = decodeURI(document.location.hash.slice(1)) : false;
            document.location.hash = '';

            var updateCanvas = function(e){
                if(e && e.keyCode && (e.keyCode == 27 || e.keyCode == 37 || e.keyCode == 38 || e.keyCode == 39 || e.keyCode == 40)) {
                    return false;
                };
                canvas.src = URL.createObjectURL(new Blob([html.value,], {type:"text/html"}));
                location.hash = html.value; // a little document.write() backup
                try{
                    log.value += '\r\n\r\n=== Additional Info ===\r\nonclick: ' + canvas.firstChild.onclick;
                    log.value += '\r\nvalue: ' + canvas.firstChild.value;
                    log.value += '\r\nstyle.cssText: ' + canvas.firstChild.style.cssText;
                    log.value += '\r\ncurrentStyle.cssText: ' + canvas.firstChild.currentStyle.cssText;
                    log.value += '\r\nruntimeStyle.cssText: ' + canvas.firstChild.runtimeStyle.cssText;
                }catch(e){e};
            };

            button.onclick = function(){
                window.open(canvas.src);
            };

            html.onkeyup = updateCanvas;
            window.onload = updateCanvas;
        </script>
    </body>
</html>
