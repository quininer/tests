<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/xhtml;charset=utf-8">
        <meta name='referrer' content='never'>
        <title>innerHTML TestTool</title>
        <script>if(document.location.protocol == 'http:')document.location.protocol = 'https';</script>
        <style>
            #canvas, #html {
                width:100%;
                height:17em;
                overflow-y:scroll
            }
        </style>
        <script src='/static/tabIndent.js'></script>
    </head>
    <body>
        <textarea id="html"></textarea><hr>
        <iframe id="canvas"></iframe><hr>
        <button id="button">Open to Tab</button>
        <script>
            var html = document.getElementById('html'),
                canvas = document.getElementById('canvas'),
                button = document.getElementById('button');

            document.location.hash.length > 1 ? html.value = decodeURI(document.location.hash.slice(1)) : false;
            document.location.hash = '';

            var updateCanvas = function(e){
                if(e && e.keyCode && !((e.keyCode == 10 || e.keyCode == 13) && e.ctrlKey)){
                    return false;
                };
                canvas.src = URL.createObjectURL(new Blob([html.value,], {type:"text/html"}));
                location.hash = html.value; // a little document.write() backup
            };

            button.onclick = function(){
                window.open(canvas.src);
            };

            html.onkeyup = updateCanvas;
            window.onload = updateCanvas;
        </script>
        <script>
            tabIndent.config.tab = '    ';
            tabIndent.render(document.getElementById('html'));
        </script>
    </body>
</html>
